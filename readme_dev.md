# SwitchBot

## GET /v1.1/devices

現在のユーザーのアカウントに追加された物理デバイスと仮想赤外線リモート デバイスを含むデバイスのリストを取得します。

```json
{
  "statusCode": 100,
  "body": {
    "deviceList": [
      {
        "deviceId": "C72D5DC53EA6", // デバイスID
        "deviceName": "ロック A6", // デバイス名
        "deviceType": "Smart Lock", // デバイスの種類
        "enableCloudService": false, // クラウドサービス有効有無
        "hubDeviceId": "000000000000" // 親ハブのID
      },
      {
        "deviceId": "DF384AD863E8", // デバイスID
        "deviceName": "キーパッド E8", // デバイス名
        "deviceType": "Keypad", // デバイスの種類
        "enableCloudService": false, // クラウドサービス有効有無
        "hubDeviceId": "000000000000", // 親ハブのID
        "lockDeviceId": "C72D5DC53EA6", // ペアリングされているロックのMACアドレス
        "keyList": [
          {
            "id": 11, // パスコードID
            "name": "常に有効パスコード1", // パスコードの名前
            "type": "permanent", // パスコードの種類
            "status": "normal", // パスコードの有効性(期限切れの場合無効)
            "createTime": 1755191665000, // パスコードが生成された日時
            "password": "2ccDDbDf5ZeOwzsz89kYTg==", // パスワード(AES-128-CBCアルゴリズムを利用して開発者秘密鍵で暗号化された文字列)
            "iv": "f1ea758ad366bc1a98bd730ddb44a48d" // 暗号化に使用される任意の番号
          }
        ]
      }
    ],
    "infraredRemoteList": []
  },
  "message": "success"
}
```

## GET /v1.1/devices/{deviceId}/status

現在のユーザーのアカウントに追加された物理デバイスのステータスを取得します。

### Lock

| 鍵             | 型      | 説明                                                                                                        |
| :------------- | :------ | :---------------------------------------------------------------------------------------------------------- |
| デバイスID     | String  | デバイスID                                                                                                  |
| デバイスタイプ | String  | デバイスの種類。スマートロック                                                                              |
| ハブデバイスID | String  | デバイスの親ハブID                                                                                          |
| バッテリー     | Integer | 4段階のバッテリーレベル区分、<10%, shown as 10;10%~20%, shown as 20;20%~60%, shown as 60;≥60%, shown as 100 |
| バージョン     | String  | 現在のファームウェアバージョン（例：V4.2）                                                                  |
| ロック状態     | String  | ロックされているかどうかを決定します                                                                        |
| ドアステート   | String  | ドアが閉まっているかどうかを判断します                                                                      |
| 調整する       | Boolean | ロックが調整されているかどうかを判断します                                                                  |

### Keypad

| 鍵             | 型     | 説明                       |
| :------------- | :----- | :------------------------- |
| デバイスID     | String | デバイスID                 |
| デバイスタイプ | String | デバイスの種類。キーパッド |
| ハブデバイスID | String | デバイスの親ハブID         |

## POST /v1.1/devices/{deviceId}/commands

物理デバイスおよび仮想赤外線リモート デバイスに制御コマンドを送信します。

### Lock

| デバイスタイプ | コマンドタイプ | 指示         | コマンドパラメータ | 説明                               |
| :------------- | :------------- | :----------- | :----------------- | :--------------------------------- |
| ロック         | 指示           | ロック       | デフォルト         | ロック位置まで回転させる           |
| ロック         | 指示           | ロック解除   | デフォルト         | ロック解除位置に回転する           |
| ロック         | 指示           | デッドボルト | デフォルト         | デッドボルトまたはラッチを解除する |

### Keypad

本製品の制御コマンドは他の製品とは動作が異なります。
セキュリティ上の懸念から、パスコードはローカルに保存されます。
この仕組みにより、パスコードを正しく生成し、Web API経由で正しい結果を取得するまでの時間が大幅に長くなります。
そのため、以下のコマンドの実際の結果はSwitchBotサーバーから非同期的に返され、Webhook経由で配信されます。
正しい結果を受け取るには、Webhook を設定する必要があります。
この製品の Webhook 定義を参照してください。

| デバイスタイプ | コマンドタイプ | 指示     | コマンドパラメータ                                                                                                                                      | 説明                       |
| :------------- | :------------- | :------- | :------------------------------------------------------------------------------------------------------------------------------------------------------ | :------------------------- |
| キーパッド     | 指示           | 作成キー | { "name": パスコード\_name_str、 "type": パスコード\_type_str、 "password": パスコード\_str、 "startTime": valid_from_long、 "endTime": valid_to_long } | 新しいパスコードを作成する |
| キーパッド     | 指示           | 削除キー | { "id": パスコードid_int }                                                                                                                              | 既存のパスコードを削除する |

次の表は、のパラメータオブジェクトについて説明していますcreateKey。

| キー名     | 値の型 | 説明                                                                                                                                                     |
| :--------- | :----- | :------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 名前       | String | パスコードの一意の名前。同じデバイス内での重複は許可されません。                                                                                         |
| タイプ     | String | パスコードの種類。permanentは永久パスコードです。timeLimit は一時的なパスコードです。disposable はワンタイムパスコードです。urgentは緊急パスコードです。 |
| パスワード | String | 6桁から12桁のパスコードをプレーンテキストで                                                                                                              |

開始時間 長さ パスコードが有効になる時間を設定します。ワンタイム パスコードと一時パスコードの場合は必須です。10 桁のタイムスタンプ。
終了時間 長さ パスコードの有効期限を設定します。ワンタイム パスコードと一時パスコードの場合は必須です。10 桁のタイムスタンプ。
次の表は、のパラメータオブジェクトについて説明していますdeleteKey。

| キー名 | 値の型 | 説明           |
| :----- | :----- | :------------- |
| id     | 弦     | パスコードのID |
